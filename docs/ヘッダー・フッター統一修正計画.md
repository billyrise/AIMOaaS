# ヘッダー・フッター統一 修正計画（SEO 観点・言語安全）

本計画は「フッター統一レポート」「ヘッダー・PSEOスタイル分析レポート」を踏まえ、**サイト全体でヘッダーとフッターを共通化する**ための実施手順と、**各言語ごとにコンテンツが異なる点で間違いが起きないようにする**ためのルール・データ設計をまとめたものです。

---

## 1. 目的と SEO 上の効果

| 目的 | SEO・UX 上の効果 |
|------|------------------|
| ヘッダー・フッターの共通化 | 内部リンクの一貫性、サイト構造の明確化、クロール効率の向上 |
| 全ページで同一のナビ・導線 | 重要ページ（トップ・実務ガイド・お問い合わせ）へのリンク重みの安定、直帰率低下 |
| PSEO にも固定ヘッダー・共通フッター | 実務ガイド群が「同一サイトの一部」であることの明示、テーマ性の強化 |
| **言語ごとの正しい表示** | hreflang と表示言語の一致、ユーザー期待との一致、クローラーの信頼性 |

---

## 2. 言語（ロケール）とセクションの定義

### 2.1 ロケール一覧（表示言語とパス接頭辞）

| ロケール | パス接頭辞 | 備考 |
|----------|------------|------|
| `ja` | `ja/` | 日本語。PSEO は **ja のみ** 存在。 |
| `en` | （ルート）`/` | 英語。`index.html`, `aimo-standard/`, `audit-firms/`, `resources/*` 等。 |
| `de` | `de/` | ドイツ語 |
| `es` | `es/` | スペイン語 |
| `fr` | `fr/` | フランス語 |
| `it` | `it/` | イタリア語 |
| `ko` | `ko/` | 韓国語 |
| `pt` | `pt/` | ポルトガル語 |
| `zh-CN` | `zh-CN/` | 簡体中国語 |
| `zh-TW` | `zh-TW/` | 繁体中国語 |

**重要**: ロケールは **必ずファイルパスから一意に判定** する。HTML 内にロケールを手書きで書かない。スクリプトまたは設定表で「パス → ロケール」を定義する。

### 2.2 セクション（ページ種別）一覧

| セクション | 説明 | ヘッダーで特別な扱い | フッター |
|------------|------|----------------------|----------|
| `main_lp` | トップページ（各言語の index） | フルナビ＋言語ドロップダウン＋CTA | 共通フル（ロゴ＋ナビ＋著作権） |
| `aimo_standard` | AIMO Standard ページ | ナビ項目少なめ、現在地「AIMO Standard」 | 共通フル |
| `audit_firms` | 監査法人向けページ | 監査法人・パートナーキット中心、CTA「パートナーブリーフィング」 | 共通フル |
| `resources` | リソース記事（ai-governance-guide, case-studies 等） | スリムナビ＋言語リンク1本 | 共通フル |
| `pseo_index` | 実務ガイド一覧（`ja/resources/pseo/index.html`） | **ja のみ**。共通ヘッダー（固定）＋「実務ガイド」現在地 | 共通フル |
| `pseo_article` | PSEO 個別記事（`ja/resources/pseo/*/index.html`） | **ja のみ**。共通ヘッダー（固定）＋パンくず「ホーム / 実務ガイド」 | 共通フル |

**注意**: `pseo_index` と `pseo_article` は現状 **日本語のみ**（`_policy/i18n-policy.md`）。他言語の PSEO を追加する場合は、別途ロケールデータとパスを拡張する。

---

## 3. 言語別文言の一元管理（間違い防止の要）

### 3.1 方針

- **すべての表示文言は「ロケール別データ」にのみ定義する。**
- HTML やテンプレートに「日本語」「英語」を直書きしない。必ず `{{nav_home}}` のようなプレースホルダー経由で挿入する。
- データファイルは **1 ファイル** にし、ロケールをキーにしたオブジェクトで管理する（例: `data/layout/locales.yaml` または `data/layout/locales.json`）。

### 3.2 データファイルの推奨構造（例: `data/layout/locales.yaml`）

```yaml
# 各ロケールで必ず同じキーを定義する。キー欠落はビルド時チェックで検出する。

ja:
  # ナビ（ヘッダー）
  nav_home: "ホーム"
  nav_risk_cost: "リスクとコスト"
  nav_solution: "サービス概要"
  nav_aimo_standard: "AIMO Standard"
  nav_resources: "リソース"
  nav_practice_guide: "実務ガイド"
  nav_audit_firms: "監査法人の皆さまへ"
  nav_partner_kit: "パートナーキット"
  nav_features: "特徴"
  nav_plans: "導入プラン"
  nav_faq: "よくある質問"
  nav_contact: "お問い合わせ"
  nav_contact_free: "無料相談"
  nav_partner_briefing: "パートナーブリーフィングを申し込む"
  # フッター
  footer_operator: "運営会社"
  footer_copyright: "© 2025 AIMOaaS™. All rights reserved."
  footer_provider_phrase: "AIMOは AI Management Office（AI管理オフィス）の略称です。AIMOaaS™ は"
  footer_provider_link: "ライズバイ株式会社（RISEby inc.）"
  # 実務ガイド（PSEO）
  breadcrumb_practice_guide: "監査・証跡（実務）"
  # 言語名（ドロップダウン用）
  lang_name: "日本語"

en:
  nav_home: "Home"
  nav_risk_cost: "Risk & Cost"
  nav_solution: "Solution"
  nav_aimo_standard: "AIMO Standard"
  nav_resources: "Resources"
  nav_practice_guide: "Practice Guide"   # 将来 en に PSEO がある場合用
  nav_audit_firms: "For Audit Firms"
  nav_partner_kit: "Partner kit"
  nav_features: "Features"
  nav_plans: "Plans"
  nav_faq: "FAQ"
  nav_contact: "Contact"
  nav_contact_free: "Free assessment"
  nav_partner_briefing: "Request partner briefing"
  footer_operator: "Operator"
  footer_copyright: "© 2025 AIMOaaS™. All rights reserved."
  footer_provider_phrase: "AIMO = AI Management Office. AIMOaaS™ is offered by"
  footer_provider_link: "RISEby inc."
  breadcrumb_practice_guide: "Practice Guide"
  lang_name: "English"

de:
  nav_home: "Startseite"
  nav_risk_cost: "Risiko & Kosten"
  # … 上と同じキーをすべて定義
  lang_name: "Deutsch"

# es, fr, it, ko, pt, zh-CN, zh-TW も同様に全キーを定義
```

- **キーは全ロケールで共通**とする。不足キーがあればビルドまたは検証スクリプトで失敗させる。
- 他言語（de, es, fr 等）は既存の各 index / aimo-standard のヘッダー・フッター文言を転記して揃える。

### 3.3 リンク URL の扱い（ロケールとパスの対応）

- ヘッダー・フッター内の **リンク先 URL** もロケールに依存する（例: 日本語トップは `https://aimoaas.com/ja/`、英語は `https://aimoaas.com/`）。
- 推奨: **ベース URL は `base_url`（例: `https://aimoaas.com`）とし、ロケールごとのパス接頭辞は別で定義する。**

  - 例: `path_prefix: { ja: "ja", en: "", de: "de", ... }`
  - トップへのリンク = `{{base_url}}/{{path_prefix}}/`
  - AIMO Standard = `{{base_url}}/{{path_prefix}}/aimo-standard/`（path_prefix が空のときは `/aimo-standard/`）
  - 実務ガイド一覧は **ja のみ** → `{{base_url}}/ja/resources/pseo/`

- これにより「英語ページのフッターに /ja/ を直書きしてしまう」といったミスを防ぐ。

---

## 4. 共通ヘッダー・共通フッターの仕様

### 4.1 共通ヘッダー（1 本化する構造）

- **固定**（`fixed w-full z-50`）、高さ `h-16`、`bg-white/90 backdrop-blur-md border-b border-slate-200`。
- **ロゴ**: 常にアイコン（Lucide shield-check）＋「AIMOaaS™」。クリックで **そのロケールのトップ** へ。
- **ナビ**: セクションに応じて表示する項目を切り替える（下表）。文言はすべて `locales[locale]` から取得。
- **言語切替**: `main_lp` と `aimo_standard` ではドロップダウン（10 言語）。それ以外は「1 本リンクで他言語トップまたは同セクション」でも可（現状のリソース記事型に近い）。
- **CTA**: セクションに応じて「無料相談」「お問い合わせ」「パートナーブリーフィング」のいずれか、または非表示。文言は locales から。
- **モバイル**: ハンバーガーメニューで同じナビ＋CTA を表示（リソース・PSEO も同様に用意する）。

**セクション別ナビ項目（方針）**

| セクション | 表示するナビ項目（例） |
|------------|------------------------|
| main_lp | リスクとコスト, サービス概要, AIMO Standard, リソース, **実務ガイド(ja のみ)**, 監査法人の皆さまへ, 特徴, 導入プラン, よくある質問 \| 言語 \| CTA |
| aimo_standard | リスクとコスト, サービス概要, **AIMO Standard（現在地）**, 特徴, 導入プラン \| 言語 |
| audit_firms | ホーム, サービス概要, AIMO Standard, **監査法人の皆さまへ（現在地）**, パートナーキット \| CTA（パートナーブリーフィング） |
| resources | サービス概要, AIMO Standard, よくある質問, シャドーAI, 用語集 \| 他言語リンク 1 本 \| お問い合わせ |
| pseo_index / pseo_article | ホーム, AIMO Standard, **実務ガイド（現在地）** \| お問い合わせ（＋ ja のみなので言語切替は「日本語」固定または English トップへの 1 リンク） |

- 「実務ガイド」リンクは **ja のときのみ** 表示する（他ロケールでは PSEO が存在しないため）。

### 4.2 共通フッター（1 本化する構造）

- **スタイル**: `bg-slate-950 text-slate-400 py-12 border-t border-slate-900`（メインLP型に合わせる）。
- **内容**:
  - ロゴ（アイコン＋AIMOaaS™）→ そのロケールのトップ
  - ナビ: ホーム, AIMO Standard, **実務ガイド（ja のみ）**, お問い合わせ（`/#contact` または `/#contact` 相当）, 運営会社（riseby.net）
  - 補足文: `footer_provider_phrase` + `footer_provider_link`（リンク）＋ `footer_copyright`
- すべて文言・リンクは `locales[locale]` と `path_prefix` から組み立て、**直書きしない**。

---

## 5. 実装フェーズと手順

### Phase 0: 準備（言語データとパス・セクション対応表）

1. **`data/layout/` ディレクトリを作成**する。
2. **`data/layout/locales.yaml`** を作成し、上記のとおり **ja / en をまず完全に定義**する。次に de, es, fr, it, ko, pt, zh-CN, zh-TW を既存 HTML から転記して揃える。
3. **`data/layout/path_config.json`**（または YAML）を作成し、**どのパスがどのロケール・セクションか**を一覧で定義する。

   例（構造のみ）:

   ```json
   {
     "base_url": "https://aimoaas.com",
     "path_prefix_by_locale": { "ja": "ja", "en": "", "de": "de", "es": "es", "fr": "fr", "it": "it", "ko": "ko", "pt": "pt", "zh-CN": "zh-CN", "zh-TW": "zh-TW" },
     "pages": [
       { "path": "ja/index.html", "locale": "ja", "section": "main_lp" },
       { "path": "index.html", "locale": "en", "section": "main_lp" },
       { "path": "ja/aimo-standard/index.html", "locale": "ja", "section": "aimo_standard" },
       { "path": "ja/resources/pseo/index.html", "locale": "ja", "section": "pseo_index" },
       { "path": "ja/resources/ai-governance-guide/index.html", "locale": "ja", "section": "resources" },
       { "path": "resources/ai-governance-guide/index.html", "locale": "en", "section": "resources" }
     ]
   }
   ```

   - `pages` は **静的 HTML の一覧**とする。PSEO 個別記事は「パターン」で扱う（`ja/resources/pseo/*/index.html` → locale=ja, section=pseo_article）。
4. **検証スクリプト**を用意する: `locales.yaml` の全ロケールで同一キーが存在するかチェック。不足があればエラーで終了。

### Phase 1: 共通パーシャルとレンダリング

1. **`templates/partials/header.html`** を作成する。プレースホルダーは `{{locale}}` ではなく、**文言はすべて変数**（`{{nav_home}}`, `{{nav_aimo_standard}}`, …）とし、**リンクは `{{base_url}}`, `{{path_prefix}}`, `{{nav_practice_guide_url}}` など**とする。セクションに応じて「表示するブロック」を変数で切り替える（例: `{{#show_practice_guide}}` … `{{/show_practice_guide}}`）か、あるいは **header はセクション別に 4〜5 種類の HTML を生成する関数**で出力してもよい（main_lp 用、aimo_standard 用、audit_firms 用、resources 用、pseo 用）。
2. **`templates/partials/footer.html`** を作成する。同様に文言・URL はすべて変数。1 本の HTML で「ロゴ・ナビ・著作権」を並べ、ナビの「実務ガイド」は **ja のときだけ表示**するフラグで制御する。
3. **Node/TS のレンダリング関数**を 1 つ用意する:  
   `renderHeader(locale, section, baseUrl)` / `renderFooter(locale, baseUrl)`  
   - `locales.yaml` と `path_config` を読み込み、`locale` に応じた文言とパスを入れ、パーシャルを文字列で返す。

### Phase 2: PSEO への組み込み（ja 固定で間違いなし）

1. **PSEO は ja のみ**なので、`generate.ts` 内で:
   - `locale = "ja"`, `section = "pseo_article"`（個別記事）または `section = "pseo_index"`（一覧）で固定する。
   - `renderHeader("ja", section, baseUrl)` と `renderFooter("ja", baseUrl)` を呼び出し、得た HTML をテンプレートに渡す。
2. **`templates/pseo/page.html`** を修正する:
   - 現在の `<header class="mb-6 text-sm">` のパンくず 1 行は、**固定ヘッダー内のパンくずエリア**に残すか、固定ヘッダーの直下に「AIMOaaS™ / 実務ガイド」のパンくずを入れる。
   - `<body>` の先頭に `{{header_html}}` を挿入（固定ヘッダー）。
   - メインコンテンツには `pt-24` を付与し、他ページと余白を揃える。
   - `</main>` の後、`</body>` の前に `{{footer_html}}` を挿入（共通フッター）。
3. **`ja/resources/pseo/index.html`** は `render_pseo_index.ts` で出力している場合は、同スクリプト内で `renderHeader("ja", "pseo_index", baseUrl)` と `renderFooter("ja", baseUrl)` を組み込み、同じパーシャルを使う。文言はすべて **ja の locales** から取得するため、他言語が混ざる心配はない。

### Phase 3: 静的 HTML への適用（ロケール・セクションを間違えない）

1. **方針**: 静的ページ（ja/index.html, index.html, de/index.html, …）は **「パス → locale, section」の対応表に従い、ヘッダー・フッターを差し替える**。
2. **方法 A（推奨）: ビルド時インジェクション**
   - 各 HTML ファイルに **マーカーコメント** を入れる:  
     `<!-- LAYOUT_HEADER locale=ja section=main_lp -->` ～ `<!-- /LAYOUT_HEADER -->`  
     および  
     `<!-- LAYOUT_FOOTER locale=ja -->` ～ `<!-- /LAYOUT_FOOTER -->`
   - ビルドスクリプトが全 HTML を走査し、パスから locale/section を取得（またはマーカーから取得）、`renderHeader(locale, section, baseUrl)` / `renderFooter(locale, baseUrl)` で生成した HTML でマーカー間を置換する。
   - **locale はマーカーではなく path_config から決定する**ようにすると、マーカー書き間違いで言語がずれるリスクを防げる。
3. **方法 B: 手動差し替え**
   - `path_config.json` の `pages` 一覧に従い、**「path → (locale, section)」の一覧表**をドキュメント化する。
   - スクリプトで「各 (locale, section) に対する header.html と footer.html の出力」をファイルに書き出す（例: `dist/layout/ja_main_lp_header.html`）。
   - 担当者が一覧表を見ながら、該当する HTML ファイルのヘッダー・フッターを **該当する生成ファイルの内容で手動置換**する。
   - **チェックリスト**で「このファイルは locale=ja, section=main_lp」「置換後、日本語の『ホーム』『実務ガイド』が表示されていること」を確認する。

### Phase 4: リソース記事・監査法人・AIMO Standard の適用

- 上記 Phase 3 と同様に、`path_config` に従って `resources/*`, `ja/resources/*`, `audit-firms/*`, `ja/audit-firms/*`, `partners/audit-firms/*`, `aimo-standard/*`, `ja/aimo-standard/*` 等をすべて登録する。
- 各ファイルで **ロケールがパスと一致しているか**（例: `resources/` 配下は en、`ja/resources/` 配下は ja）を確認する。**リソース記事は ja と en の両方がある**ため、`path_config` の `locale` を間違えないこと。

### Phase 5: 検証とリグレッション防止

1. **言語一致チェック**
   - スクリプトで「各 HTML の `<html lang="...">` と、そのファイルの path から導いた locale が一致しているか」を検証する（例: `ja/index.html` → lang は `ja`、`index.html` → lang は `en`）。
   - ヘッダー・フッター内に **他ロケールの文言が含まれていないか** を、各ロケールの `locales` の値のリストを使ってチェックする（例: en ページの HTML に「ホーム」「実務ガイド」が含まれていたら警告。ただし「実務ガイド」は英語ページでは "Practice Guide" なので、日本語の「実務ガイド」が en ページに出ていたらエラー）。
2. **リンク先チェック**
   - 各ロケールのページから、フッターの「ホーム」リンクが正しくそのロケールのトップを指すか（例: `de/index.html` のフッターのホームは `/de/`）を検証する。
3. **CI への組み込み**
   - 上記検証を `scripts/validate-layout.ts` のようなスクリプトにまとめ、PR 時またはビルド時に実行する。

---

## 6. ロケール・セクション対応の一覧（実施時の参照用）

実施時に「このファイルはどの locale / section か」を間違えないよう、**一覧表を 1 ファイルで管理**することを推奨する。以下は例である。

| パス（代表） | ロケール | セクション |
|--------------|----------|------------|
| `ja/index.html` | ja | main_lp |
| `index.html` | en | main_lp |
| `de/index.html`, `es/index.html`, … | de, es, … | main_lp |
| `ja/aimo-standard/index.html` | ja | aimo_standard |
| `aimo-standard/index.html`, `de/aimo-standard/index.html`, … | en, de, … | aimo_standard |
| `ja/audit-firms/index.html` | ja | audit_firms |
| `audit-firms/index.html`, `partners/audit-firms/index.html` | en | audit_firms |
| `ja/resources/ai-governance-guide/index.html` 他 | ja | resources |
| `resources/ai-governance-guide/index.html` 他 | en | resources |
| `ja/resources/pseo/index.html` | ja | pseo_index |
| `ja/resources/pseo/*/index.html`（全個別記事） | ja | pseo_article |

- **PSEO はすべて ja**。他言語の PSEO を将来追加するまでは、`pseo_index` / `pseo_article` の locale は常に ja とする。

---

## 7. まとめ・注意事項

| 項目 | 内容 |
|------|------|
| **文言の一元化** | すべて `data/layout/locales.yaml`（または JSON）で管理。HTML に直書きしない。 |
| **ロケールの決定** | 必ず **パス**（または path_config）から決定。手書きで locale を書かない。 |
| **リンク URL** | `base_url` と `path_prefix_by_locale` から組み立て。ja 用リンクを en ページに貼らない。 |
| **実務ガイドの表示** | ヘッダー・フッターの「実務ガイド」リンクは **ja のときのみ** 表示。 |
| **PSEO** | 現状は ja のみ。generate.ts と render_pseo_index.ts では `locale = "ja"` 固定でレンダリング。 |
| **検証** | ビルドまたは CI で「lang と path の一致」「他ロケール文言の混入なし」「リンク先がそのロケールのトップであること」をチェックする。 |

この計画に沿って実装すれば、**各言語ごとにコンテンツが異なる点で間違いが起きないように**しつつ、サイト全体でヘッダー・フッターを SEO 観点で最適な形に統一できる。

---

## 8. 実施済み（Phase 2: PSEO）

- **data/layout/locales.yaml**: 10 ロケール分の文言を一元管理。監査・ガバナンスで使われる表現を採用（例: 独 Für Wirtschaftsprüfer、西 Para firmas de auditoría、韓 감사법인、中 致审计机构／致會計師事務所）。
- **templates/partials/header-pseo.html, footer.html**: PSEO 用共通ヘッダー・フッターのパーシャル。
- **scripts/pseo/layout.ts**: `renderHeaderPseo(locale, baseUrl)` と `renderFooter(locale, baseUrl, options)` を提供。
- **templates/pseo/page.html**: 固定ヘッダー・共通フッター（`{{header_html}}` / `{{footer_html}}`）を組み込み。メインに `pt-24` を付与。
- **scripts/pseo/generate.ts**: レンダリング時に `header_html` / `footer_html` を挿入。
- **scripts/pseo/render_pseo_index.ts**: 一覧ページにも同一ヘッダー・フッターを出力。
- **scripts/pseo/postprocess_inject_layout.ts**: 既存の PSEO 個別記事に共通ヘッダー・フッターを一括注入。`npm run postprocess:layout` で実行可能。100 件を適用済み。

---

## 9. 実施済み（Phase 3–4: 静的ページ）

- **data/layout/path_config.json**: 静的ページの path → locale, section 対応表。main_lp（各言語 index）、aimo_standard、audit_firms、resources を定義。
- **data/layout/locales.yaml**: `nav_shadow_ai`, `nav_glossary` を全ロケールに追加（resources セクション用）。
- **templates/partials/header-static.html**: 静的ページ用共通ヘッダー（セクション別ナビ・言語切替・CTA）。
- **scripts/pseo/layout.ts**: `loadPathConfig()`, `getLocaleIndexUrl()`, `renderHeaderStatic(locale, section, baseUrl)`, `getStaticPagesConfig()` を追加。URL は path_prefix から組み立て（二重スラッシュなし）。
- **scripts/pseo/postprocess_static_layout.ts**: path_config に従い、各静的 HTML の `<header class="...fixed...">` ブロックと `<footer>` を共通ヘッダー・フッターで置換。古いモバイルメニュー残骸を削除。`npm run postprocess:static` で実行。43 件を適用済み。
- 正規表現は `<header class="...fixed...">` に限定し、`</head>` / `<body>` を誤って削除しないようにした。
